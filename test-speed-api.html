<!DOCTYPE html>
<html>
<head>
    <title>Speed Test API Check</title>
</head>
<body>
    <h1>Speed Test API Check</h1>
    <button onclick="testAPI()">Test API</button>
    <div id="result"></div>

    <script>
        // Replace with your actual API key from .env
        const API_KEY = 'AIzaSyAuIUxZbicuP80YynrGhRnPMs5XcUlX65Q';
        const testUrl = 'https://www.google.com';

        async function testAPI() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<p>Testing API...</p>';

            try {
                const apiUrl = `https://www.googleapis.com/pagespeedonline/v5/runPagespeed?url=${encodeURIComponent(testUrl)}&strategy=mobile&key=${API_KEY}`;
                
                console.log('Testing URL:', apiUrl.replace(API_KEY, 'API_KEY_HIDDEN'));
                
                const response = await fetch(apiUrl);
                const data = await response.json();

                if (data.error) {
                    resultDiv.innerHTML = `
                        <h2 style="color: red;">❌ API Error</h2>
                        <p><strong>Error:</strong> ${data.error.message}</p>
                        <p><strong>Code:</strong> ${data.error.code || 'N/A'}</p>
                        <p><strong>Status:</strong> ${data.error.status || 'N/A'}</p>
                    `;
                } else if (data.lighthouseResult) {
                    const score = Math.round((data.lighthouseResult.categories?.performance?.score || 0) * 100);
                    resultDiv.innerHTML = `
                        <h2 style="color: green;">✅ API Working!</h2>
                        <p><strong>Test URL:</strong> ${testUrl}</p>
                        <p><strong>Performance Score:</strong> ${score}</p>
                        <p><strong>Status:</strong> ${response.status} ${response.statusText}</p>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <h2 style="color: orange;">⚠️ Unexpected Response</h2>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <h2 style="color: red;">❌ Request Failed</h2>
                    <p><strong>Error:</strong> ${error.message}</p>
                    <p>This might be a CORS issue or network problem.</p>
                `;
            }
        }
    </script>
</body>
</html>

